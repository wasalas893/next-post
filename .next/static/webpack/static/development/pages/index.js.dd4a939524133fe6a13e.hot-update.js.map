{"version":3,"file":"static/webpack/static\\development\\pages\\index.js.dd4a939524133fe6a13e.hot-update.js","sources":["webpack:///./components/index/PostFeed.js"],"sourcesContent":[" import Typography from \"@material-ui/core/Typography\";\nimport withStyles from \"@material-ui/core/styles/withStyles\";\n\nimport NewPost from './NewPost';\nimport Post from './Post';\nimport { addPost,deletePost,getPostFeed,likePost,unlikePost } from '../../lib/api';\n\nclass PostFeed extends React.Component {\n  state = {\n    posts:[],\n    text:\"\",\n    image:\"\",\n    isAddingPost:false,\n    isDeletingPost:false\n  };\n  componentDidMount(){\n    this.postData=new FormData();\n    this.getPosts()\n  }\n  getPosts=()=>{\n    const { auth }=this.props;\n\n    getPostFeed(auth.user._id).then(posts=>this.setState({ posts }))\n  }\n\n  handleChange = event => {\n    let inputValue;\n\n    if (event.target.name === \"image\") {\n      inputValue = event.target.files[0];\n    \n    } else {\n      inputValue = event.target.value;\n    }\n    this.postData.set(event.target.name, inputValue);\n    this.setState({ [event.target.name]: inputValue });\n  };\n\n\n  handleAddPost=()=>{\n    const { auth }=this.props;\n       this.setState({ isAddingPost:true })\n    addPost(auth.user._id,this.postData)\n    .then(postData=>{\n      const updatedPosts=[postData,...this.state.posts]\n      this.setState({\n        posts:updatedPosts,\n        isAddingPost:false,\n        text:\"\",\n        image:\"\"\n      })\n      this.postData.delete('image')\n    })\n    .catch(err=>{\n      console.error(err);\n      this.setState({ isAddingPost:false })\n    })\n    }\n\n    handleDeletePost=deletedPost=>{\n      this.setState({ isDeletingPost:true })\n\n      deletePost(deletedPost._id)\n       .then(postData=>{\n         const postIndex=this.state.posts.findIndex(post=>post._id==postData._id)\n         const updatePosts=[\n          ...this.state.posts.slice(0,postIndex),\n          ...this.state.posts.splice(postIndex + 1)\n         ]\n         this.setState({\n           posts:updatePosts,\n           isDeletingPost:false\n         })\n       }).catch(err=>{\n         console.error(err);\n         this.setState({ isDeletingPost:false })\n       })\n\n    };\n\n\n    handleToggleLike= post =>{\n     const { auth }=this.props;\n\n     const isPostLiked=post.likes.includes(auth.user._id)\n     const sendRequest=isPostLiked ? unlikePost : likePost;\n     sendRequest(post._id)\n     .then(postData=>{\n       const postIndex=this.state.posts.findIndex(\n        post\n       )\n     })\n    };\n\n  render() {\n\n     const { classes,auth }=this.props;\n     const { posts,text, image,isAddingPost,isDeletingPost }=this.state;\n\n    return (\n      <div className={classes.root}>\n        <Typography variant=\"h4\" component=\"h1\" align=\"center\"\n        color=\"primary\" className={classes.title}>\n          Post Feed\n        </Typography>\n        <NewPost\n          auth={auth}\n          text={text}\n          image={image}\n          isAddingPost={isAddingPost}\n          handleChange={this.handleChange}\n          handleAddPost={this.handleAddPost}\n        />\n        {/*post list*/}\n\n        {posts.map(post=>(\n          <Post\n            key={post._id}\n            auth={auth}\n            post={post}\n            isDeletingPost={isDeletingPost}\n            handleDeletePost={this.handleDeletePost}\n            handleToggleLike={this.handleToggleLike}\n          />\n        ))}\n      </div>\n    );\n  }\n}\n\nconst styles = theme => ({\n  root: {\n    paddingBottom: theme.spacing.unit * 2\n  },\n  title: {\n    padding: theme.spacing.unit * 2\n  }\n});\n\nexport default withStyles(styles)(PostFeed);\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AACA;AAUA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AAEA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AAJA;AACA;AAKA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AAAA;AAAA;AACA;AAAA;AACA;AAGA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AAEA;AAAA;AAGA;AACA;AACA;AAEA;AAGA;AACA;AACA;;;;;;AA9EA;AACA;AACA;AACA;;;AA4EA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AADA;AAKA;AACA;AACA;AACA;AACA;AACA;AANA;AAUA;AAEA;AACA;AACA;AACA;AACA;AACA;AANA;AADA;AAYA;;;;AAxHA;AACA;AA0HA;AAAA;AACA;AACA;AADA;AAGA;AACA;AADA;AAJA;AAAA;AACA;AAQA;;;;A","sourceRoot":""}